// -----------------------------------------------------------------------------
//   Omnipedia <media> element partial
// -----------------------------------------------------------------------------

.omnipedia-media {
  &--style-framed {
    @include omnipedia-card($padding: $omnipedia-infobox-outer-spacing);

    @include set-colours(
      $background: $secondary-content-background-colour-light
    );

    @include on-dark-colour-scheme {
      @include set-colours(
        $background: $secondary-content-background-colour-dark
      );
    }
  }

  @at-root {
    // This uses the same vertical spacing as other content elements, and
    // specifically the same as <p> elements.
    @include vertical-spacing-against-previous(
      '.omnipedia-media',
      $spacing-small: $content-item-vertical-spacing-small,
      $spacing-large: $content-item-vertical-spacing-large
    );
  }

  .media {
    @include omnipedia-card($padding: 0);

    img {
      // This provides a background colour when images haven't loaded yet or
      // they have transparency, which helps contrast and stand out from the
      // media element frame.
      @include set-colours(
        $background: $primary-content-background-colour-light
      );

      @include on-dark-colour-scheme {
        @include set-colours(
          $background: $primary-content-background-colour-dark
        );
      }
    }
  }

  figure {
    // Override normalize.css.
    margin: 0;
  }

  figcaption {
    @include omnipedia-card-caption;
  }
}

// This replaces the Classy CSS for the Drupal core media embed error element
// and adds dark colour scheme support. The Omnipedia media element generates it
// if there's an error building the media element.
//
// @see core/themes/classy/css/components/media-embed-error.css
//   Based on this Classy CSS file.
//
// @todo Convert the icon to a vector (SVG) and convert the media embed error
//   sizing to ems or rems.
.media-embed-error,
.caption > .media-embed-error {
  $error-icon-size: 100px;

  position: relative;

  max-width:  200px;
  padding:    $error-icon-size 20px 20px;

  @include set-colours(
    $background: $secondary-content-background-colour-light
  );

  @include on-dark-colour-scheme {
    @include set-colours(
      $background: $secondary-content-background-colour-dark
    );
  }

  &::before {
    content: '';

    display: block;

    position: absolute;

    top:  0;
    left: 50%;

    width:  $error-icon-size;
    height: $error-icon-size;

    margin-left: -($error-icon-size / 2);

    background-image:     url(
      '../../../../core/modules/media/images/icons/no-thumbnail.png'
    );
    background-repeat:    no-repeat;
    background-position:  center top;
    background-size:      $error-icon-size $error-icon-size;

    // This inverts the icon on dark colour schemes so that it contrasts better.
    @include on-dark-colour-scheme {
      filter: invert(100%);
    }
  }
}
