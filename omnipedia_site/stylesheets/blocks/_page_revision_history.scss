// -----------------------------------------------------------------------------
//   Page revision history block partial
// -----------------------------------------------------------------------------

@use 'sass:math';

///
/// Omnipedia page revisions block line colour on light backgrounds.
///
/// @require {variable} $divider-colour-on-light
///
$omnipedia-page-revisions-block-line-colour-on-light: $divider-colour-on-light;

///
/// Omnipedia page revisions block line colour on dark backgrounds.
///
/// @require {variable} $divider-colour-on-dark
///
$omnipedia-page-revisions-block-line-colour-on-dark: $divider-colour-on-dark;

///
/// Omnipedia page revisions block line thickness.
///
/// @require {variable} $divider-thickness
///
$omnipedia-page-revisions-block-line-thickness: $divider-thickness;

///
/// Omnipedia page revisions block item spacing.
///
/// @require {variable} $general-spacing
///
$omnipedia-page-revisions-block-item-spacing: $general-spacing * 1.3;

///
/// Omnipedia page revisions block item padding.
///
/// @require {variable} $general-spacing
///
$omnipedia-page-revisions-block-item-padding: $general-spacing;

.omnipedia-wiki-page-revisions {

  $self: &;

  &__list {

    @include unlisted-list;

    max-height: 30vh;

    scroll-snap-type: y mandatory;

    // This vertical line is meant to represent the time axis. On LTR the line
    // is on the left, while on RTL it's on the right.
    @include root-conditions(('[dir=ltr]'), 'html') {
      border-left:
        $omnipedia-page-revisions-block-line-thickness
        solid
        $omnipedia-page-revisions-block-line-colour-on-light;

      @include on-dark-colour-scheme {
        border-left-color: $omnipedia-page-revisions-block-line-colour-on-dark;
      }
    }
    @include root-conditions(('[dir=rtl]'), 'html') {
      border-right:
        $omnipedia-page-revisions-block-line-thickness
        solid
        $omnipedia-page-revisions-block-line-colour-on-light;

      @include on-dark-colour-scheme {
        border-right-color: $omnipedia-page-revisions-block-line-colour-on-dark;
      }
    }

    // Remove the vertical margins as they'll no longer be collapsed due to
    // overflow-x on the container.
    margin-top:     0;
    margin-bottom:  0;

    &-item {

      scroll-snap-align: start;

      // The last item aligns to the end/bottom of its block rather than the
      // start/top.
      &:last-child {
        scroll-snap-align: end;
      }

      // Remove bottom margin. Direction required for specificity over Classy.
      @include root-conditions(('[dir=ltr]', '[dir=rtl]'), 'html') {
        margin-bottom: 0;
      }

      // Spacing between items. Direction required for specificity over Classy.
      * + & {
        @include root-conditions(('[dir=ltr]', '[dir=rtl]'), 'html') {
          margin-top: $omnipedia-page-revisions-block-item-spacing;
        }
      }

      @include root-conditions(('[dir=ltr]'), 'html') {
        padding-left:   $omnipedia-page-revisions-block-item-padding;
      }
      @include root-conditions(('[dir=rtl]'), 'html') {
        padding-right:  $omnipedia-page-revisions-block-item-padding;
      }

      // This horizontal line is meant to represent individual revisions
      // branching off of the time axis.
      border-bottom:
        $omnipedia-page-revisions-block-line-thickness
        solid
        $omnipedia-page-revisions-block-line-colour-on-light;

      @include on-dark-colour-scheme {
        border-bottom-color:
          $omnipedia-page-revisions-block-line-colour-on-dark;
      }

    }

    &-item-status {
      font-size: 85%;
    }

  }

  // Scrollbar hide stuff starts here.

  @include scrollbar-hide-container;

  &__list {

    @include scrollbar-hide-scroller;

    --scroll-hide-scroller-padding-top: calc(
      var(--scrollbar-hide-fade-distance) * 0.75
    );

    &-item {
      @include scrollbar-hide-child;
    }

  }

  &::before, &::after {
    content: '';
  }

  &::before {
    @include scrollbar-hide-fade(top);
  }

  &::after {
    @include scrollbar-hide-fade(bottom);
  }

  &:hover, &:focus-within {
    #{$self}__list {
      @include scrollbar-hide-scroller-scrollbar-visible;
    }

    #{$self}__list-item {
      @include scrollbar-hide-child-scrollbar-visible;
    }

    &::before, &::after {
      @include scrollbar-hide-fade-scrollbar-visible;
    }
  }

}

* + .omnipedia-wiki-page-revisions-toggle {
  margin-top: math.div($omnipedia-page-revisions-block-item-spacing, 2);
}
